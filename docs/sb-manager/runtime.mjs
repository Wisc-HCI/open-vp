import{a as te,b as T,c as F,d as f,e as d,f as g,g as u,h as L,i as D,j as y,k as I,l as b,m as K,n as x,p as B}from"./chunk-YRUERJGD.mjs";import{a as C}from"./chunk-ZZWMINIV.mjs";import"./chunk-2EZFOXCN.mjs";import{a as ee}from"./chunk-U4FGYVCJ.mjs";import"./chunk-M6WCQ5XD.mjs";import{a as v,b as h,d as k,e as N,s as $}from"./chunk-OPTKCFWO.mjs";import{b as Z}from"./chunk-7P7MBUK4.mjs";import"./chunk-JVL5FG27.mjs";import"./chunk-XMWX3DS4.mjs";import{e as c}from"./chunk-7AG3PZXC.mjs";var E=c(v());var w=c(v(),1);var P=c(te(),1),{window:n,document:p,location:S}=w.default,H="storybook-channel",re={allowFunction:!0,maxDepth:25},oe=class{constructor(e){if(this.config=e,this.buffer=[],this.handler=null,n&&n.addEventListener("message",this.handleEvent.bind(this),!1),e.page!=="manager"&&e.page!=="preview")throw new Error(`postmsg-channel: "config.page" cannot be "${e.page}"`)}setHandler(e){this.handler=(...t)=>{e.apply(this,t),!this.connected&&this.getLocalFrame().length&&(this.flush(),this.connected=!0)}}send(e,t){let{target:r,allowRegExp:o,allowFunction:s,allowSymbol:i,allowDate:a,allowUndefined:l,allowClass:q,maxDepth:M,space:G,lazyEval:V}=t||{},z=Object.fromEntries(Object.entries({allowRegExp:o,allowFunction:s,allowSymbol:i,allowDate:a,allowUndefined:l,allowClass:q,maxDepth:M,space:G,lazyEval:V}).filter(([m,O])=>typeof O<"u")),J={...re,...w.default.CHANNEL_OPTIONS||{},...z},R=this.getFrames(r),Q=P.default.parse(S.search,{ignoreQueryPrefix:!0}),X=g({key:H,event:e,refId:Q.refId},J);return R.length?(this.buffer.length&&this.flush(),R.forEach(m=>{try{m.postMessage(X,"*")}catch{console.error("sending over postmessage fail")}}),Promise.resolve(null)):new Promise((m,O)=>{this.buffer.push({event:e,resolve:m,reject:O})})}flush(){let{buffer:e}=this;this.buffer=[],e.forEach(t=>{this.send(t.event).then(t.resolve).catch(t.reject)})}getFrames(e){if(this.config.page==="manager"){let t=[...p.querySelectorAll("iframe[data-is-storybook][data-is-loaded]")].filter(r=>{try{return!!r.contentWindow&&r.dataset.isStorybook!==void 0&&r.id===e}catch{return!1}}).map(r=>r.contentWindow);return t.length?t:this.getCurrentFrames()}return n&&n.parent&&n.parent!==n?[n.parent]:[]}getCurrentFrames(){return this.config.page==="manager"?[...p.querySelectorAll('[data-is-storybook="true"]')].map(e=>e.contentWindow):n&&n.parent?[n.parent]:[]}getLocalFrame(){return this.config.page==="manager"?[...p.querySelectorAll("#storybook-preview-iframe")].map(e=>e.contentWindow):n&&n.parent?[n.parent]:[]}handleEvent(e){try{let{data:t}=e,{key:r,event:o,refId:s}=typeof t=="string"&&d(t)?u(t,w.default.CHANNEL_OPTIONS||{}):t;if(r===H){let i=this.config.page==="manager"?'<span style="color: #37D5D3; background: black"> manager </span>':'<span style="color: #1EA7FD; background: black"> preview </span>',a=Object.values(f).includes(o.type)?`<span style="color: #FF4785">${o.type}</span>`:`<span style="color: #FFAE00">${o.type}</span>`;if(s&&(o.refId=s),o.source=this.config.page==="preview"?e.origin:ne(e),!o.source){k.error(`${i} received ${a} but was unable to determine the source of the event`);return}let l=`${i} received ${a} (${t.length})`;k.debug(S.origin!==o.source?l:`${l} <span style="color: gray">(on ${S.origin} from ${o.source})</span>`,...o.args),this.handler(o)}}catch(t){h.error(t)}}},ne=e=>{let t=[...p.querySelectorAll("iframe[data-is-storybook]")],[r,...o]=t.filter(s=>{try{return s.contentWindow===e.source}catch{}let i=s.getAttribute("src"),a;try{({origin:a}=new URL(i,p.location))}catch{return!1}return a===e.origin});if(r&&o.length===0){let s=r.getAttribute("src"),{protocol:i,host:a,pathname:l}=new URL(s,p.location);return`${i}//${a}${l}`}return o.length>0&&h.error("found multiple candidates for event source"),null};function Y({page:e}){let t=new oe({page:e});return new y({transport:t})}var _=c(v(),1);var{WebSocket:ae}=_.default,ie=class{constructor({url:e,onError:t}){this.buffer=[],this.isReady=!1,this.connect(e,t)}setHandler(e){this.handler=e}send(e){this.isReady?this.sendNow(e):this.sendLater(e)}sendLater(e){this.buffer.push(e)}sendNow(e){let t=g(e,{maxDepth:15,allowFunction:!0});this.socket.send(t)}flush(){let{buffer:e}=this;this.buffer=[],e.forEach(t=>this.send(t))}connect(e,t){this.socket=new ae(e),this.socket.onopen=()=>{this.isReady=!0,this.flush()},this.socket.onmessage=({data:r})=>{let o=typeof r=="string"&&d(r)?u(r):r;this.handler(o)},this.socket.onerror=r=>{t&&t(r)}}};function U({url:e,async:t=!1,onError:r=o=>h.warn(o)}){let o=new ie({url:e,onError:r});return new y({transport:o,async:t})}var ce=c(Z()),pe=c(ee());var W={react:ce,"react-dom":pe,"@storybook/components":D,"@storybook/channels":I,"@storybook/core-events":f,"@storybook/router":T,"@storybook/theming":$,"@storybook/api":L,"@storybook/addons":K,"@storybook/client-logger":N};var{FEATURES:he,SERVER_CHANNEL_URL:j}=E.default,A=class extends x{constructor(){super();let r=Y({page:"manager"});if(b.setChannel(r),r.emit(F),this.addons=b,this.channel=r,he?.storyStoreV7&&j){let o=U({url:j});this.serverChannel=o,b.setServerChannel(this.serverChannel)}}getElements(r){return this.addons.getElements(r)}getConfig(){return this.addons.getConfig()}handleAPI(r){this.addons.loadAddons(r)}},{document:me}=E.default,fe=me.getElementById("root");B(fe,new A);Object.keys(C).forEach(e=>{E.default[C[e]]=W[e]});
