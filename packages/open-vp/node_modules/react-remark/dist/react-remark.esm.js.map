{"version":3,"file":"react-remark.esm.js","sources":["../src/index.ts"],"sourcesContent":["import {\n  FunctionComponent,\n  Fragment,\n  ReactElement,\n  createElement,\n  useState,\n  useEffect,\n  useCallback,\n} from 'react';\nimport unified, { PluggableList } from 'unified';\nimport remarkParse, { RemarkParseOptions } from 'remark-parse';\nimport { Options as RemarkRehypeOptions } from 'mdast-util-to-hast';\nimport remarkToRehype from 'remark-rehype';\nimport rehypeReact, { Options as RehypeReactOptions } from 'rehype-react';\n\ntype PartialBy<T, K extends keyof T> = Omit<T, K> & Partial<Pick<T, K>>;\n\nexport interface UseRemarkSyncOptions {\n  remarkParseOptions?: RemarkParseOptions;\n  remarkToRehypeOptions?: RemarkRehypeOptions;\n  rehypeReactOptions?: PartialBy<\n    RehypeReactOptions<typeof createElement>,\n    'createElement'\n  >;\n  remarkPlugins?: PluggableList;\n  rehypePlugins?: PluggableList;\n}\n\nexport const useRemarkSync = (\n  source: string,\n  {\n    remarkParseOptions,\n    remarkToRehypeOptions,\n    rehypeReactOptions,\n    remarkPlugins = [],\n    rehypePlugins = [],\n  }: UseRemarkOptions = {}\n): ReactElement =>\n  unified()\n    .use(remarkParse, remarkParseOptions)\n    .use(remarkPlugins)\n    .use(remarkToRehype, remarkToRehypeOptions)\n    .use(rehypePlugins)\n    .use(rehypeReact, {\n      createElement,\n      Fragment,\n      ...rehypeReactOptions,\n    } as RehypeReactOptions<typeof createElement>)\n    .processSync(source).result as ReactElement;\n\nexport interface UseRemarkOptions extends UseRemarkSyncOptions {\n  onError?: (err: Error) => void;\n}\n\nexport const useRemark = ({\n  remarkParseOptions,\n  remarkToRehypeOptions,\n  rehypeReactOptions,\n  remarkPlugins = [],\n  rehypePlugins = [],\n  onError = () => {},\n}: UseRemarkOptions = {}): [ReactElement | null, (source: string) => void] => {\n  const [reactContent, setReactContent] = useState<ReactElement | null>(null);\n\n  const setMarkdownSource = useCallback((source: string) => {\n    unified()\n      .use(remarkParse, remarkParseOptions)\n      .use(remarkPlugins)\n      .use(remarkToRehype, remarkToRehypeOptions)\n      .use(rehypePlugins)\n      .use(rehypeReact, {\n        createElement,\n        Fragment,\n        ...rehypeReactOptions,\n      } as RehypeReactOptions<typeof createElement>)\n      .process(source)\n      .then((vfile) => setReactContent(vfile.result as ReactElement))\n      .catch(onError);\n  }, []);\n\n  return [reactContent, setMarkdownSource];\n};\n\nexport interface RemarkProps extends UseRemarkOptions {\n  children: string;\n}\n\nexport const Remark: FunctionComponent<RemarkProps> = ({\n  children,\n  ...useRemarkOptions\n}: RemarkProps) => {\n  const [reactContent, setMarkdownSource] = useRemark(useRemarkOptions);\n\n  useEffect(() => {\n    setMarkdownSource(children);\n  }, [children, setMarkdownSource]);\n\n  return reactContent;\n};\n"],"names":["useRemarkSync","source","remarkParseOptions","remarkToRehypeOptions","rehypeReactOptions","remarkPlugins","rehypePlugins","unified","use","remarkParse","remarkToRehype","rehypeReact","createElement","Fragment","processSync","result","useRemark","onError","useState","reactContent","setReactContent","setMarkdownSource","useCallback","process","then","vfile","Remark","children","useRemarkOptions","useEffect"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IA4BaA,aAAa,GAAG,SAAhBA,aAAgB,CAC3BC,MAD2B;AAAA,gCAQL,EARK;AAAA,MAGzBC,kBAHyB,QAGzBA,kBAHyB;AAAA,MAIzBC,qBAJyB,QAIzBA,qBAJyB;AAAA,MAKzBC,kBALyB,QAKzBA,kBALyB;AAAA,gCAMzBC,aANyB;AAAA,MAMzBA,aANyB,mCAMT,EANS;AAAA,gCAOzBC,aAPyB;AAAA,MAOzBA,aAPyB,mCAOT,EAPS;;AAAA,SAU3BC,OAAO,GACJC,GADH,CACOC,WADP,EACoBP,kBADpB,EAEGM,GAFH,CAEOH,aAFP,EAGGG,GAHH,CAGOE,cAHP,EAGuBP,qBAHvB,EAIGK,GAJH,CAIOF,aAJP,EAKGE,GALH,CAKOG,WALP;AAMIC,IAAAA,aAAa,EAAbA,aANJ;AAOIC,IAAAA,QAAQ,EAARA;AAPJ,KAQOT,kBARP,GAUGU,WAVH,CAUeb,MAVf,EAUuBc,MApBI;AAAA;IA0BhBC,SAAS,GAAG,SAAZA,SAAY;kCAOH;MANpBd,2BAAAA;MACAC,8BAAAA;MACAC,2BAAAA;kCACAC;MAAAA,iDAAgB;kCAChBC;MAAAA,iDAAgB;4BAChBW;MAAAA,qCAAU;;AAEV,kBAAwCC,QAAQ,CAAsB,IAAtB,CAAhD;AAAA,MAAOC,YAAP;AAAA,MAAqBC,eAArB;;AAEA,MAAMC,iBAAiB,GAAGC,WAAW,CAAC,UAACrB,MAAD;AACpCM,IAAAA,OAAO,GACJC,GADH,CACOC,WADP,EACoBP,kBADpB,EAEGM,GAFH,CAEOH,aAFP,EAGGG,GAHH,CAGOE,cAHP,EAGuBP,qBAHvB,EAIGK,GAJH,CAIOF,aAJP,EAKGE,GALH,CAKOG,WALP;AAMIC,MAAAA,aAAa,EAAbA,aANJ;AAOIC,MAAAA,QAAQ,EAARA;AAPJ,OAQOT,kBARP,GAUGmB,OAVH,CAUWtB,MAVX,EAWGuB,IAXH,CAWQ,UAACC,KAAD;AAAA,aAAWL,eAAe,CAACK,KAAK,CAACV,MAAP,CAA1B;AAAA,KAXR,WAYSE,OAZT;AAaD,GAdoC,EAclC,EAdkC,CAArC;AAgBA,SAAO,CAACE,YAAD,EAAeE,iBAAf,CAAP;AACD;IAMYK,MAAM,GAAmC,SAAzCA,MAAyC;MACpDC,iBAAAA;MACGC;;AAEH,mBAA0CZ,SAAS,CAACY,gBAAD,CAAnD;AAAA,MAAOT,YAAP;AAAA,MAAqBE,iBAArB;;AAEAQ,EAAAA,SAAS,CAAC;AACRR,IAAAA,iBAAiB,CAACM,QAAD,CAAjB;AACD,GAFQ,EAEN,CAACA,QAAD,EAAWN,iBAAX,CAFM,CAAT;AAIA,SAAOF,YAAP;AACD;;;;"}